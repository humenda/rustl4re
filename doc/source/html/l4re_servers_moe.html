<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>L4Re – L4 Runtime Environment: Moe, the Root-Task</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="l4re.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">L4Re – L4 Runtime Environment
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('l4re_servers_moe.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Moe, the Root-Task </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Moe is the default root-task implementation for L4Re-based systems.</p>
<p><em>Moe</em> is the first task which is usually started in L4Re-based systems. The micro kernel starts <em>Moe</em> as the Root-Task.</p>
<h1><a class="anchor" id="l4re_moe_objects"></a>
Moe objects</h1>
<p>Moe provides a default implementation for the basic <a class="el" href="namespaceL4Re.html" title="L4Re C++ Interfaces.">L4Re</a> abstractions, such as data spaces (<a class="el" href="classL4Re_1_1Dataspace.html" title="Interface for memory-like objects.">L4Re::Dataspace</a>), region maps (<a class="el" href="classL4Re_1_1Rm.html" title="Region map.">L4Re::Rm</a>), memory allocators (<a class="el" href="classL4_1_1Factory.html" title="C++ Factory interface.">L4::Factory</a>, <a class="el" href="classL4Re_1_1Mem__alloc.html" title="Memory allocation interface.">L4Re::Mem_alloc</a>), name spaces (<a class="el" href="classL4Re_1_1Namespace.html" title="Name-space interface.">L4Re::Namespace</a>) and so on (see <a class="el" href="group__api__l4re.html">L4Re Interface</a>). These are described in the following subsections.</p>
<h2><a class="anchor" id="l4re_moe_factory"></a>
Factory</h2>
<p>The factory in Moe is responsible for all kinds of dynamic object allocation.</p>
<p>Moe's factory allows allocation of the following objects:</p><ul>
<li><a class="el" href="classL4Re_1_1Namespace.html" title="Name-space interface.">L4Re::Namespace</a></li>
<li><a class="el" href="classL4Re_1_1Dataspace.html" title="Interface for memory-like objects.">L4Re::Dataspace</a>, RAM allocation</li>
<li><a class="el" href="classL4Re_1_1Dma__space.html" title="DMA Address Space.">L4Re::Dma_space</a>, memory management for DMA-capable devices</li>
<li><a class="el" href="classL4Re_1_1Rm.html" title="Region map.">L4Re::Rm</a>, virtual memory management for application tasks</li>
<li><a class="el" href="classL4_1_1Vcon.html" title="C++ L4 Vcon interface.">L4::Vcon</a> (output only)</li>
<li><a class="el" href="classL4_1_1Scheduler.html" title="C++ interface of the Scheduler kernel object.">L4::Scheduler</a>, to provide a restricted priority / CPU range for clients</li>
<li><a class="el" href="classL4_1_1Factory.html" title="C++ Factory interface.">L4::Factory</a>, to provide a quota limited allocation for clients</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="classL4_1_1Scheduler.html" title="C++ interface of the Scheduler kernel object.">L4::Scheduler</a> objects can be only created through the user factory provided by Moe to the initial application. Other factory instances cannot create this object.</dd></dl>
<h3><a class="anchor" id="l4re_moe_memory_alloc_factory"></a>
Passing parameters to the create stream</h3>
<p><a class="el" href="classL4_1_1Factory.html#ab52604d4abed4d6009ce51a59492edd7" title="Generic create call to the factory.">L4::Factory.create()</a> returns a <a class="el" href="classL4_1_1Factory_1_1S.html">create stream</a> that allows arguments to be forwarded to the the object creation in Moe.</p>
<p>Objects that support additional parameters on their creation are presented next with a non-empty list of parameters. The parameters are listed in the order they should be provided to a create stream. Optional parameters are identified by their default values. Multiple entries in the next list denote different ways of initializing an object.</p>
<ul>
<li><a class="el" href="classL4Re_1_1Namespace.html" title="Name-space interface.">L4Re::Namespace</a> <code>()</code><ul>
<li>For more details see <a class="el" href="l4re_servers_moe.html#l4re_moe_names">Namespace</a></li>
</ul>
</li>
<li><a class="el" href="classL4Re_1_1Dataspace.html" title="Interface for memory-like objects.">L4Re::Dataspace</a> <code>(l4_mword_t size, l4_umword_t flags = 0, l4_umword_t align = 0)</code><ul>
<li>Argument <code>size</code>: size in bytes (mandatory)</li>
<li>Argument <code>flags</code>: special dataspace properties, see <a class="el" href="classL4Re_1_1Mem__alloc.html#a47f3e054def977c17dbf60bfbb4ee05e" title="Flags for the allocator.">L4Re::Mem_alloc::Mem_alloc_flags</a></li>
<li>Argument <code>align</code>: Log2 alignment of dataspace if supported by allocator</li>
<li>See detailed description of the parameters in <a class="el" href="classL4Re_1_1Mem__alloc.html#a44b301573ae859e8406400338cc8e924" title="Allocate anonymous memory.">L4Re::Mem_alloc::alloc()</a></li>
<li>For details on the types of dataspaces provided by Moe, see <a class="el" href="l4re_servers_moe.html#l4re_moe_dataspace">Dataspace</a></li>
</ul>
</li>
<li><a class="el" href="classL4Re_1_1Dma__space.html" title="DMA Address Space.">L4Re::Dma_space</a> <code>()</code><ul>
<li>For more details see <a class="el" href="l4re_servers_moe.html#l4re_moe_dma_space">DMA Space</a></li>
</ul>
</li>
<li><a class="el" href="classL4Re_1_1Rm.html" title="Region map.">L4Re::Rm</a> <code>()</code><ul>
<li>For more details see <a class="el" href="l4re_servers_moe.html#l4re_moe_rm">Region Map</a></li>
</ul>
</li>
<li><a class="el" href="classL4_1_1Vcon.html" title="C++ L4 Vcon interface.">L4::Vcon</a> <code>(char const *label, l4_mword_t color = 7)</code><ul>
<li>Argument <code>label</code>: label used as prefix for the console output</li>
<li>Argument <code>color</code>: color code <code>0..15</code></li>
<li>For more details see <a class="el" href="l4re_servers_moe.html#l4re_moe_log">Log Subsystem</a></li>
</ul>
</li>
<li><a class="el" href="classL4_1_1Vcon.html" title="C++ L4 Vcon interface.">L4::Vcon</a> <code>(char const *label, char const *color = "w")</code><ul>
<li>Argument <code>label</code>: label used as prefix for the console output</li>
<li>Argument <code>color</code>: color code<ul>
<li>The color is identified by a single character</li>
<li>Supported colors: <code>N</code>, <code>n</code>, <code>R</code>, <code>r</code>, <code>G</code>, <code>g</code>, <code>Y</code>, <code>y</code>, <code>B</code>, <code>b</code>, <code>M</code>, <code>m</code>, <code>C</code>, <code>c</code>, <code>W</code>, <code>w</code></li>
</ul>
</li>
<li>For more details see <a class="el" href="l4re_servers_moe.html#l4re_moe_log">Log Subsystem</a></li>
</ul>
</li>
<li><a class="el" href="classL4_1_1Scheduler.html" title="C++ interface of the Scheduler kernel object.">L4::Scheduler</a> <code>(l4_mword_t limit, l4_mword_t offset, l4_umword_t bitmap = ~0UL)</code><ul>
<li>Argument <code>limit</code>: maximum priority</li>
<li>Argument <code>offset</code>: priority offset</li>
<li>Argument <code>bitmap</code>: bitmap of CPUs</li>
<li>Argument <code>limit</code> must be greater than <code>offset</code></li>
<li>For more details see <a class="el" href="l4re_servers_moe.html#l4re_moe_scheduler">Scheduler subsystem</a></li>
</ul>
</li>
<li><a class="el" href="classL4_1_1Factory.html" title="C++ Factory interface.">L4::Factory</a> <code>(l4_mword_t quota)</code><ul>
<li>Argument <code>quota</code>: limit in bytes (not zero)</li>
<li>The limit is deducted from the limit of the factory that creates the new factory</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="l4re_moe_names"></a>
Namespace</h2>
<p>Moe provides a name space conforming to the <a class="el" href="classL4Re_1_1Namespace.html" title="Name-space interface.">L4Re::Namespace</a> interface (see <a class="el" href="group__api__l4re__namespace.html">Name-space API</a>). Per default Moe creates a single name space for the <a class="el" href="l4re_servers_moe.html#l4re_moe_bootfs">Boot FS</a>. That is available as <code>rom</code> in the initial objects of the init process.</p>
<h3><a class="anchor" id="l4re_moe_bootfs"></a>
Boot FS</h3>
<p>The Boot FS subsystem provides access to the files loaded during the platform boot (or available in ROM). These files are either linked into the boot image or loaded via a flexible boot loader, such as GRUB.</p>
<p>The subsystem provides an <a class="el" href="classL4Re_1_1Namespace.html" title="Name-space interface.">L4Re::Namespace</a> object as directory and an <a class="el" href="classL4Re_1_1Dataspace.html" title="Interface for memory-like objects.">L4Re::Dataspace</a> object for each file.</p>
<p>By default all files are read only and visible in the namespace <em><code>rom</code></em>. As an option, files can be supplied with the argument <code>:rw</code> to mark them as writable modules. Moe will allow read and write access to these dataspaces and make them visible in a different namespace called <em><code>rwfs</code></em>.</p>
<p>An example entry in 'modules.list' would look like this:</p>
<div class="fragment"><div class="line">module somemodule :rw</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>In order for a client to receive write permissions to the dataspace, the corresponding cap also needs write permissions.</dd></dl>
<h2><a class="anchor" id="l4re_moe_dataspace"></a>
Dataspace</h2>
<p>Dataspaces can be allocated with an arbitrary size. The granularity for memory allocation however is the machine page size (<a class="el" href="group__l4__memory__api.html#gabecf862d8b8f39ad28af45d7fc949dd5" title="Minimal page size (in bytes).">L4_PAGESIZE</a>). A dataspace user must be aware that, as a result of this page-size granularity, there may be padding memory at the end of a dataspace which is accessible to each client. Moe currently allows most dataspace operations on this padding area. Nonetheless, the client must not make any assumptions about the size or content of the padding area, as this behaviour might change in the future.</p>
<p>The provided data spaces can have different characteristics:</p><ul>
<li>Physically contiguous and pre-allocated</li>
<li>Non contiguous and on-demand allocated with possible copy on write (COW)</li>
</ul>
<h2><a class="anchor" id="l4re_moe_log"></a>
Log Subsystem</h2>
<p>The logging facility of Moe provides per application tagged and synchronized log output.</p>
<h2><a class="anchor" id="l4re_moe_dma_space"></a>
DMA Space</h2>
<h2><a class="anchor" id="l4re_moe_scheduler"></a>
Scheduler subsystem</h2>
<p>The scheduler subsystem provides a simple scheduler proxy for scheduling policy enforcement.</p>
<p>The priority offset provided on the creation of a scheduler proxy defines the minimum priority assigned to threads which are scheduled by that instance of the scheduler proxy. The offset is implicitly added to priorities provided to <a class="el" href="classL4_1_1Scheduler.html#acc86cb4df9b2aad35730b209e0c98089" title="Run a thread on a Scheduler.">L4::Scheduler.run_thread()</a>.</p>
<h2><a class="anchor" id="l4re_moe_rm"></a>
Region Map</h2>
<h1><a class="anchor" id="l4re_moe_options"></a>
Command Line Options</h1>
<p>Moe's command-line syntax is: </p><pre class="fragment">moe [--debug=&lt;flags&gt;] [--init=&lt;binary&gt;] [--l4re-dbg=&lt;flags&gt;] [--ldr-flags=&lt;flags&gt;] [-- &lt;init options&gt;]
</pre> <dl class="section user"><dt>--debug=&lt;debug flags&gt;</dt><dd>This option enables debug messages from Moe itself, the <code>&lt;debug flags&gt;</code> values are a combination of <code>info</code>, <code>warn</code>, <code>boot</code>, <code>server</code>, <code>loader</code>, <code>exceptions</code>, and <code>ns</code> (or <code>all</code> for full verbosity).</dd></dl>
<dl class="section user"><dt>--init=&lt;init process&gt;</dt><dd>This options allows to override the default init process binary, which is 'rom/ned'.</dd></dl>
<dl class="section user"><dt>--l4re-dbg=&lt;debug flags&gt;</dt><dd>This option allows to set the debug options for the <a class="el" href="namespaceL4Re.html" title="L4Re C++ Interfaces.">L4Re</a> runtime environment of the init process. The flags are the same as for <code>--debug=</code>.</dd></dl>
<dl class="section user"><dt>--ldr-flags=&lt;loader flags&gt;</dt><dd>This option allows setting some loader options for the <a class="el" href="namespaceL4Re.html" title="L4Re C++ Interfaces.">L4Re</a> runtime environment. The flags are <code>pre_alloc</code>, <code>all_segs_cow</code>,and <code>pinned_segs</code>.</dd></dl>
<dl class="section user"><dt>-- &lt;init options&gt;</dt><dd>All command-line parameters after the special <code>--</code> option are passed directly to the init process. </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="l4re_servers.html">L4Re Servers</a></li>
    <li class="footer">Generated on Sat Jul 17 2021 20:10:08 for L4Re – L4 Runtime Environment by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
